{"version":3,"file":"livewire-confirm-modal.js","sources":["../js/livewire-confirm-modal.js"],"sourcesContent":["document.addEventListener('alpine:init', () => {\n    Alpine.store('confirmModal', {\n        show: false,\n        title: 'default',\n\n        toggle(){\n            this.show = !this.show;\n            console.log(\"Show? \" + this.show);\n        },\n\n        setTitle(title) {\n            this.title = title\n            console.log(\"Title? \" + this.title);\n        }\n    })\n})\n\nfunction parseMethod(element){\n    let method = rawMethod\n    let params = []\n    const methodAndParamString = method.match(/(.*?)\\((.*)\\)/s)\n\n    if (methodAndParamString) {\n        method = methodAndParamString[1]\n\n        // Use a function that returns it's arguments to parse and eval all params\n        // This \"$event\" is for use inside the livewire event handler.\n        let func = new Function('$event', `return (function () {\n                for (var l=arguments.length, p=new Array(l), k=0; k<l; k++) {\n                    p[k] = arguments[k];\n                }\n                return [].concat(p);\n            })(${methodAndParamString[2]})`)\n\n        params = func(this.eventContext)\n    }\n\n    return { method, params }\n}\n\nfunction getParams(element){\n\n}\n\n\nLivewire.directive('confirm-modal', ({ el, directive, component, cleanup }) => {\n    let content =  directive.expression\n\n    // The \"directive\" object gives you access to the parsed directive.\n    // For example, here are its values for: wire:click.prevent=\"deletePost(1)\"\n    //\n    // directive.raw = wire:click.prevent\n    // directive.value = \"click\"\n    // directive.modifiers = ['prevent']\n    // directive.expression = \"deletePost(1)\"\n\n    console.log(el);\n    console.log(el.getAttribute('wire:click'));\n    console.log(parseMethod(el.getAttribute('wire:click')))\n    console.log(component);\n\n    const newConfirm = () => {\n        return new Promise((complete, failed)=>{\n\n            document.getElementById(\"lvcm-ok\").addEventListener(\"click\", function(){\n                Alpine.store('confirmModal').toggle();\n                console.log('ok onclick');\n                complete(true);\n            });\n\n            document.getElementById(\"lvcm-cancel\").addEventListener(\"click\", function(){\n                Alpine.store('confirmModal').toggle();\n                console.log('cancel onclick');\n                complete(false);\n            });\n\n        });\n    }\n\n    let onClick = async e => {\n        e.preventDefault()\n        e.stopImmediatePropagation()\n\n        Alpine.store('confirmModal').setTitle('Test');\n        Alpine.store('confirmModal').toggle();\n\n        if (!await newConfirm()) {\n            console.log('cancel');\n\n        }else{\n            console.log('ok');\n            debugger;\n            component.$wire[el.getAttribute('wire:click')]();\n            debugger;\n        }\n    }\n\n    el.addEventListener('click', onClick, { capture: true })\n\n    cleanup(() => {\n        el.removeEventListener('click', onClick)\n    })\n})\n"],"names":["title","parseMethod","element","method","params","methodAndParamString","el","directive","component","cleanup","newConfirm","complete","failed","onClick","e"],"mappings":"AAAA,SAAS,iBAAiB,cAAe,IAAM,CAC3C,OAAO,MAAM,eAAgB,CACzB,KAAM,GACN,MAAO,UAEP,QAAQ,CACJ,KAAK,KAAO,CAAC,KAAK,KAClB,QAAQ,IAAI,SAAW,KAAK,IAAI,CACnC,EAED,SAASA,EAAO,CACZ,KAAK,MAAQA,EACb,QAAQ,IAAI,UAAY,KAAK,KAAK,CACrC,CACT,CAAK,CACL,CAAC,EAED,SAASC,EAAYC,EAAQ,CACzB,IAAIC,EAAS,UACTC,EAAS,CAAE,EACf,MAAMC,EAAuBF,EAAO,MAAM,gBAAgB,EAE1D,OAAIE,IACAF,EAASE,EAAqB,CAAC,EAW/BD,EAPW,IAAI,SAAS,SAAU;AAAA;AAAA;AAAA;AAAA;AAAA,iBAKzBC,EAAqB,CAAC,CAAC,GAAG,EAErB,KAAK,YAAY,GAG5B,CAAE,OAAAF,EAAQ,OAAAC,CAAQ,CAC7B,CAOA,SAAS,UAAU,gBAAiB,CAAC,CAAE,GAAAE,EAAI,UAAAC,EAAW,UAAAC,EAAW,QAAAC,KAAc,CAC5DF,EAAU,WAUzB,QAAQ,IAAID,CAAE,EACd,QAAQ,IAAIA,EAAG,aAAa,YAAY,CAAC,EACzC,QAAQ,IAAIL,EAAYK,EAAG,aAAa,YAAY,CAAC,CAAC,EACtD,QAAQ,IAAIE,CAAS,EAErB,MAAME,EAAa,IACR,IAAI,QAAQ,CAACC,EAAUC,IAAS,CAEnC,SAAS,eAAe,SAAS,EAAE,iBAAiB,QAAS,UAAU,CACnE,OAAO,MAAM,cAAc,EAAE,OAAM,EACnC,QAAQ,IAAI,YAAY,EACxBD,EAAS,EAAI,CAC7B,CAAa,EAED,SAAS,eAAe,aAAa,EAAE,iBAAiB,QAAS,UAAU,CACvE,OAAO,MAAM,cAAc,EAAE,OAAM,EACnC,QAAQ,IAAI,gBAAgB,EAC5BA,EAAS,EAAK,CAC9B,CAAa,CAEb,CAAS,EAGL,IAAIE,EAAU,MAAMC,GAAK,CAOrB,GANAA,EAAE,eAAgB,EAClBA,EAAE,yBAA0B,EAE5B,OAAO,MAAM,cAAc,EAAE,SAAS,MAAM,EAC5C,OAAO,MAAM,cAAc,EAAE,OAAM,EAE/B,CAAC,MAAMJ,IACP,QAAQ,IAAI,QAAQ,MAEnB,CACD,QAAQ,IAAI,IAAI,EAChB,SACAF,EAAU,MAAMF,EAAG,aAAa,YAAY,CAAC,EAAC,EAC9C,QACH,CACJ,EAEDA,EAAG,iBAAiB,QAASO,EAAS,CAAE,QAAS,GAAM,EAEvDJ,EAAQ,IAAM,CACVH,EAAG,oBAAoB,QAASO,CAAO,CAC/C,CAAK,CACL,CAAC"}